vertex.label.cex=0,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=E(subs2)$weight,
vertex.label.font=2,
vertex.label.cex=0,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
edges1 = read.csv('/Users/emg/Programming/GitHub/cmv/tidy_data/edgelist_subset.csv')
nodes1 = read.csv('/Users/emg/Programming/GitHub/cmv/tidy_data/nodelist_subset.csv')
net1 =
graph_from_data_frame(d=edges1, vertices=nodes1) %>%
simplify(remove.loops = T)
V(net1)$type = nodes$type # make bipartite
# get one-mode net1work
pr1=bipartite.projection(net1)
subs1 = pr1$proj2
E(subs1)$arrow.size = 0
V(subs1)$degree = degree(subs1)
V(subs1)$cmv = as.integer(V(subs1)$name=='changemyview')
V(subs1)$color=V(subs1)$cmv
V(subs1)$color=gsub("1","red",V(subs1)$color)
V(subs1)$color=gsub("0","black",V(subs1)$color)
V(subs1)$color
## TD NETWORK
edges2 = read.csv('/Users/emg/Programming/GitHub/the_donald_project/tidy_data/edgelist_subset.csv')
nodes2 = read.csv('/Users/emg/Programming/GitHub/the_donald_project/tidy_data/nodelist_subset.csv')
net2 =
graph_from_data_frame(d=edges2, vertices=nodes2) %>%
simplify(remove.loops = T)
# get one-mode net2work
V(net2)$type = nodes$type # make bipartite
pr2=bipartite.projection(net2)
subs2 = pr2$proj2
E(subs2)$arrow.size = 0
V(subs2)$degree = degree(subs2)
# highlight TD in red
V(subs2)$td = as.integer(V(subs2)$name=='The_Donald')
V(subs2)$color=V(subs2)$td
V(subs2)$color=gsub("1","red",V(subs2)$color)
V(subs2)$color=gsub("0","black",V(subs2)$color)
V(subs2)$color
## PLOTTING SUBREDDIT NETWORKS
par(mfrow=(c(1,2)))
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=E(subs1)$weight,
vertex.label.font=2,
vertex.label.cex=0,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=E(subs2)$weight,
vertex.label.font=2,
vertex.label.cex=0,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
par(mfrow=(c(1,2)))
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=E(subs1)$weight,
vertex.label.font=1,
vertex.label.cex=0.5,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=E(subs2)$weight,
vertex.label.font=2,
vertex.label.cex=0,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
par(mfrow=(c(1,2)))
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=E(subs1)$weight,
vertex.label.font=1,
vertex.label.cex=0.7,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=E(subs2)$weight,
vertex.label.font=1,
vertex.label.cex=0,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
par(mfrow=(c(1,2)))
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=E(subs1)$weight,
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=E(subs2)$weight,
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
range(E(mods2)$weight)
mean(E(mods2)$weight)
sd(E(mods2)$weight)
range(E(subs1)$weight)
mean(E(subs1)$weight)
sd(E(subs1)$weight)
range(E(subs2)$weight)
mean(E(subs2)$weight)
sd(E(subs2)$weight)
hist(E(subs1)$weight, breaks=20, xlab="Degree",
cex.lab=1.2, cex.main=1.4,
main="Histogram of CMV sub edge weights")
hist(E(subs2)$weight, breaks=20, xlab="Degree",
cex.lab=1.2, cex.main=1.4,
main="Histogram of TD sub edge weights")
hist(log(E(subs2)$weight), breaks=20, xlab="Degree",
cex.lab=1.2, cex.main=1.4,
main="Histogram of TD sub edge weights")
source('~/Programming/GitHub/R-mod-nets/simple-plots.R')
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/sub-nets.png',
width=680,height=512)
{
par(mfrow=(c(1,2)))
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
}
dev.off()
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/sub-nets.png',
width=800,height=650)
{
par(mfrow=(c(1,2)))
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
}
dev.off()
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/sub-nets.png',
width=850,height=60)
{
par(mfrow=(c(1,2)))
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
}
dev.off()
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/sub-nets.png',
width=850,height=600)
{
par(mfrow=(c(1,2)))
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
}
dev.off()
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/sub-nets.png',
width=850,height=550)
{
par(mfrow=(c(1,2)))
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
}
dev.off()
wrap_strings <- function(vector_of_strings,width){
as.character(sapply(vector_of_strings, FUN=function(x){
paste(strwrap(x, width=width), collapse="\n")
}))
}
# Apply the function to wrap the node labels
V(subs2)$label = wrap_strings(V(subs2)$label, 12)
V(subs2)$label
V(subs2)$label = wrap_strings(V(subs2)$name, 12)
V(subs2)$label = wrap_strings(V(subs2)$name, 12)
V(subs2)$label
layout.by.attr <- function(graph, wc, cluster.strength=1,layout=layout.auto) {
g <- graph.edgelist(get.edgelist(graph)) # create a lightweight copy of graph w/o the attributes.
E(g)$weight <- 1
attr <- cbind(id=1:vcount(g), val=wc)
g <- g + vertices(unique(attr[,2])) + igraph::edges(unlist(t(attr)), weight=cluster.strength)
l <- layout(g, weights=E(g)$weight)[1:vcount(graph),]
return(l)
}
plot(subs2,
#layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.8,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network',
layout=layout.by.attr(subs2, wc=1))
plot(subs1,
layout = layout1,
#vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
#vertex.label.font=1,
#vertex.label.cex=0.8,
#vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
plot(subs1,
layout = layout1,
#vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
#vertex.label.font=1,
#vertex.label.cex=0.8,
#vertex.label.color=V(subs1)$color,
vertex.label.color="white"
main = 'CMV subreddit network')
plot(subs1,
layout = layout1,
#vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
#vertex.label.font=1,
#vertex.label.cex=0.8,
#vertex.label.color=V(subs1)$color,
vertex.label.color="white",
main = 'CMV subreddit network')
plot(subs1,
layout = layout1,
#vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
#vertex.label.font=1,
#vertex.label.cex=0.8,
#vertex.label.color=V(subs1)$color,
vertex.label.color=n=NA,
main = 'CMV subreddit network')
plot(subs1,
layout = layout1,
#vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
#vertex.label.font=1,
#vertex.label.cex=0.8,
#vertex.label.color=V(subs1)$color,
vertex.label.color=NA,
main = 'CMV subreddit network')
plot(subs1,
layout = layout1,
#vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
#vertex.label.font=1,
#vertex.label.cex=0.8,
#vertex.label.color=V(subs1)$color,
vertex.label=NA,
main = 'CMV subreddit network')
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.7,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/sub-nets.png',
width=900,height=550)
{
par(mfrow=(c(1,2)))
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.7,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.7,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
}
dev.off()
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/sub-nets.png',
width=900,height=550)
{
par(mfrow=(c(1,2)))
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.85,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.85,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
}
dev.off()
par(mfrow=(c(1,1)))
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/cmv-sub-net.png',
width=500,height=225)
layout1 = layout.fruchterman.reingold(subs1)
plot(subs1,
layout = layout1,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.85,
vertex.label.color=V(subs1)$color,
main = 'CMV subreddit network')
dev.off()
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/td-sub-net.png',
width=500,height=225)
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.85,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
dev.off()
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/td-sub-net.png',
width=900,height=525)
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.85,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
dev.off()
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/td-sub-net.png',
width=1200,height=1000)
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.85,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
dev.off()
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/td-sub-net.png',
width=1200,height=1000)
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=1.5,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
dev.off()
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/td-sub-net.png',
width=1000,height=800)
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=0.85,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
dev.off()
png(filename='/Users/emg/Google Drive/PhD/presenting/ss_phd_seminar_april_17/visuals/td-sub-net.png',
width=1000,height=800)
layout2 = layout.fruchterman.reingold(subs2)
plot(subs2,
layout = layout2,
vertex.shape = 'none',
edge.width=log(E(subs1)$weight),
vertex.label.font=1,
vertex.label.cex=1,
vertex.label.color=V(subs2)$color,
main = 'TD subreddit network')
dev.off()
source('~/Programming/GitHub/R-mod-nets/simple-plots.R')
